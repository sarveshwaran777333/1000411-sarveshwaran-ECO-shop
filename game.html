<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Eco Robo Runner</title>

<style>
body {
  margin: 0;
  background: #e8f5e9;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: Arial;
}

.game-container {
  background: white;
  border: 3px solid #2e7d32;
  border-radius: 15px;
  padding: 15px;
  text-align: center;
}

canvas {
  background: #f1f8e9;
  border-radius: 10px;
  display: none;
}

.menu {
  width: 820px;
  height: 320px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.controls {
  margin-top: 10px;
}

button {
  padding: 8px 18px;
  font-size: 16px;
  margin: 5px;
  border-radius: 6px;
  border: 2px solid #2e7d32;
  background: #c8e6c9;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="game-container">

  <div id="menu" class="menu">
    <h1>ðŸ¤– Eco Robo Runner</h1>
    <p>SPACE = Jump | P = Pause</p>
    <button onclick="startGame()">Start Game</button>
  </div>

  <canvas id="game" width="820" height="320"></canvas>

  <div class="controls">
    <button id="pauseBtn" onclick="togglePause()" style="display:none;">Pause</button>
    <button id="restartBtn" onclick="restartGame()" style="display:none;">Restart</button>
  </div>

</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const pauseBtn = document.getElementById("pauseBtn");
const restartBtn = document.getElementById("restartBtn");

/* ROBO IMAGE â€” DRAW FULL IMAGE */
const robo = new Image();
let roboLoaded = false;
robo.src = "ROBO.png";
robo.onload = () => roboLoaded = true;

/* GAME STATE */
let running = false;
let paused = false;
let gameOver = false;

/* PHYSICS */
const groundY = 200;
let y = groundY;
let vy = 0;
const gravity = 0.6;
const jumpPower = -21;
let jumps = 0;
const maxJumps = 2;
const SPEED = 4;

/* OBJECTS */
let coins = [];
let obstacles = [];
let score = 0;

/* INPUT */
document.addEventListener("keydown", e => {
  if (e.code === "Space" && running && !paused && !gameOver && jumps < maxJumps) {
    vy = jumpPower;
    jumps++;
  }
  if (e.code === "KeyP" && running && !gameOver) togglePause();
});

/* GAME FLOW */
function startGame() {
  menu.style.display = "none";
  canvas.style.display = "block";
  pauseBtn.style.display = "inline-block";
  restartBtn.style.display = "none";
  reset();
  running = true;
}

function togglePause() {
  paused = !paused;
  pauseBtn.textContent = paused ? "Resume" : "Pause";
}

function restartGame() {
  reset();
  running = true;
  paused = false;
  gameOver = false;
  restartBtn.style.display = "none";
}

function reset() {
  coins = [];
  obstacles = [];
  score = 0;
  y = groundY;
  vy = 0;
  jumps = 0;
}

/* SPAWN */
function spawnCoins() {
  if (Math.random() < 0.02) {
    coins.push({
      x: canvas.width,
      y: Math.random() < 0.7 ? groundY + 25 : groundY - 40,
      r: 9
    });
  }
}

function spawnObstacles() {
  if (Math.random() < 0.02) {
    obstacles.push({
      x: canvas.width,
      y: groundY + 30,
      w: 30,
      h: 30,
      type: Math.random() < 0.6 ? "block" : "spike"
    });
  }
}

/* UPDATE */
function update() {
  if (!running || paused || gameOver) return;

  vy += gravity;
  y += vy;

  let onBlock = false;

  obstacles.forEach(o => {
    if (o.type === "block") {
      if (50 + 60 > o.x && 50 < o.x + o.w && y + 60 >= o.y && vy >= 0) {
        y = o.y - 60;
        vy = 0;
        jumps = 0;
        onBlock = true;
      }
    }
    if (o.type === "spike") {
      if (50 + 60 > o.x && 50 < o.x + o.w && y + 60 > o.y) {
        gameOver = true;
        running = false;
        restartBtn.style.display = "inline-block";
      }
    }
  });

  if (!onBlock && y >= groundY) {
    y = groundY;
    vy = 0;
    jumps = 0;
  }

  spawnCoins();
  spawnObstacles();

  coins.forEach(c => c.x -= SPEED);
  obstacles.forEach(o => o.x -= SPEED);

  coins = coins.filter(c => {
    const hit = Math.abs(80 - c.x) < 20 && Math.abs(y + 30 - c.y) < 20;
    if (hit) score++;
    return c.x > -20 && !hit;
  });
}

/* DRAW */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#81c784";
  ctx.fillRect(0, groundY + 60, canvas.width, 6);

  /* EFFECT BEHIND ROBO */
  ctx.globalAlpha = 0.3;
  ctx.fillStyle = "#66bb6a";
  ctx.beginPath();
  ctx.ellipse(80, y + 55, 26, 10, 0, 0, Math.PI * 2);
  ctx.fill();
  ctx.globalAlpha = 1;

  /* ROBO â€” ALWAYS DRAW IMAGE */
  if (roboLoaded) {
    ctx.drawImage(robo, 50, y, 60, 60);
  }

  /* COINS */
  ctx.fillStyle = "gold";
  coins.forEach(c => {
    ctx.beginPath();
    ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
    ctx.fill();
  });

  /* OBSTACLES */
  obstacles.forEach(o => {
    if (o.type === "block") {
      ctx.fillStyle = "#6d4c41";
      ctx.fillRect(o.x, o.y, o.w, o.h);
    } else {
      ctx.fillStyle = "#d32f2f";
      ctx.beginPath();
      ctx.moveTo(o.x, o.y + o.h);
      ctx.lineTo(o.x + o.w / 2, o.y);
      ctx.lineTo(o.x + o.w, o.y + o.h);
      ctx.fill();
    }
  });

  ctx.fillStyle = "#1b5e20";
  ctx.font = "bold 20px Arial";
  ctx.fillText("Coins: " + score, 20, 30);

  if (paused) {
    ctx.fillStyle = "rgba(0,0,0,0.6)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "white";
    ctx.fillText("PAUSED", 360, 160);
  }

  if (gameOver) {
    ctx.fillStyle = "rgba(0,0,0,0.7)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "white";
    ctx.fillText("GAME OVER", 330, 150);
  }
}

/* LOOP */
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
